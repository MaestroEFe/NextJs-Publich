(()=>{var e={};e.id=8921,e.ids=[8921],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},61212:e=>{"use strict";e.exports=require("async_hooks")},84770:e=>{"use strict";e.exports=require("crypto")},76162:e=>{"use strict";e.exports=require("stream")},21764:e=>{"use strict";e.exports=require("util")},84492:e=>{"use strict";e.exports=require("node:stream")},36741:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>l}),t(96407),t(6324),t(98355),t(48663);var r=t(91711),a=t(90149),i=t(82226),o=t.n(i),n=t(75394),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let l=["",{children:["(auth)",{children:["reset-password",{children:["[token]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,96407)),"/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/(auth)/reset-password/[token]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6324)),"/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/(auth)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,98355,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,48663)),"/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,98355,23)),"next/dist/client/components/not-found-error"]}],u=["/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/(auth)/reset-password/[token]/page.tsx"],c="/(auth)/reset-password/[token]/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(auth)/reset-password/[token]/page",pathname:"/reset-password/[token]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},91449:(e,s,t)=>{Promise.resolve().then(t.bind(t,91061))},25383:(e,s,t)=>{Promise.resolve().then(t.bind(t,26484))},65516:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,67545,23)),Promise.resolve().then(t.t.bind(t,73654,23)),Promise.resolve().then(t.t.bind(t,11104,23)),Promise.resolve().then(t.t.bind(t,2614,23)),Promise.resolve().then(t.t.bind(t,17115,23)),Promise.resolve().then(t.t.bind(t,84452,23))},67258:()=>{},91061:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(60134),a=t(31267),i=t(96791),o=t(86819),n=t(68658),d=t(62175),l=t(51551);let u=()=>{let e=(0,i.useRouter)(),s=(0,i.useParams)().token,[t,u]=(0,a.useState)(""),[c,p]=(0,a.useState)(""),{register:m,handleSubmit:h,formState:{errors:x}}=(0,o.cI)({resolver:(0,n.F)(d.S4)}),g=async t=>{u(""),p("");try{let r=await fetch(`/api/auth/reset-password/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t.password})}),a=await r.json();r.ok?(p(a.message),setTimeout(()=>e.push("/login"),3e3)):u(a.message||"Failed to reset password.")}catch(e){u("An unexpected error occurred.")}};return c?(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Password Reset Successful"}),r.jsx("p",{className:"text-green-500",children:c}),r.jsx("p",{children:"You will be redirected to the login page shortly."}),r.jsx(l.default,{href:"/login",className:"text-blue-500 hover:underline",children:"Or click here to login now."})]}):(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Set New Password"}),(0,r.jsxs)("form",{onSubmit:h(g),className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"password",children:"New Password"}),r.jsx("input",{type:"password",id:"password",...m("password"),className:"w-full p-2 border border-gray-300 rounded"}),x.password&&r.jsx("p",{className:"text-red-500 text-sm",children:x.password.message})]}),t&&r.jsx("p",{className:"text-red-500",children:t}),r.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Reset Password"})]})]})}},26484:(e,s,t)=>{"use strict";t.d(s,{default:()=>i});var r=t(60134),a=t(48141);let i=({children:e})=>r.jsx(a.SessionProvider,{children:e})},62175:(e,s,t)=>{"use strict";t.d(s,{gY:()=>l.gY,S4:()=>l.S4});var r=t(11185),a=t.n(r);t(19092);var i=t(39568),o=t.n(i);let n=new r.Schema({name:{type:String,required:[!0,"Please provide your name"],trim:!0},email:{type:String,required:[!0,"Please provide your email"],unique:!0,trim:!0,lowercase:!0,match:[/.+@.+\..+/,"Please enter a valid email address"]},password:{type:String,required:[!0,"Please provide a password"],minlength:6,select:!1},group:{type:String,enum:["user","admin"],default:"user"},isVerified:{type:Boolean,default:!1},verificationToken:{type:String,select:!1},verificationTokenExpires:{type:Date,select:!1},passwordResetToken:{type:String,select:!1},passwordResetTokenExpires:{type:Date,select:!1}},{timestamps:!0});n.pre("save",async function(e){if(!this.isModified("password")||!this.password)return e();let s=await o().genSalt(10);this.password=await o().hash(this.password,s),e()}),n.methods.comparePassword=async function(e){return!!this.password&&await o().compare(e,this.password)},a().models.User||a().model("User",n),new(t(95538)).R(process.env.RESEND_API_KEY),process.env.EMAIL_FROM;let d=new r.Schema({email:{type:String,required:!0},token:{type:String,required:!0,unique:!0},expiresAt:{type:Date,required:!0,expires:"1h"}});a().models.PasswordResetToken||a().model("PasswordResetToken",d);var l=t(7606)},7606:(e,s,t)=>{"use strict";t.d(s,{dm:()=>i,gY:()=>a,S4:()=>n,gV:()=>o});var r=t(95626);let a=r.z.object({name:r.z.string().min(3,{message:"Name must be at least 3 characters long"}),email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})}),i=r.z.object({email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(1,{message:"Password is required"})}),o=r.z.object({name:r.z.string().min(3).optional(),email:r.z.string().email().optional()}),n=r.z.object({password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})})},6324:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(31837);t(60122);let a=({children:e})=>r.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:r.jsx("div",{className:"w-full max-w-md p-8 space-y-8 bg-white shadow-lg rounded-lg",children:e})})},96407:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(71694).createProxy)(String.raw`/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/(auth)/reset-password/[token]/page.tsx#default`)},48663:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u,metadata:()=>l});var r=t(31837),a=t(68819),i=t.n(a),o=t(97113),n=t.n(o);t(26751);let d=(0,t(71694).createProxy)(String.raw`/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/contexts/AuthProvider.tsx#default`),l={title:"OrisGate - Your Gateway to Study Abroad",description:"OrisGate helps students study abroad and provides seamless visa processing services. Your journey to international education starts here.",keywords:"study abroad, visa processing, international education, student travel, OrisGate"};function u({children:e}){return r.jsx("html",{lang:"en",className:`${i().variable} ${n().variable}`,children:r.jsx("body",{className:i().className,children:r.jsx(d,{children:e})})})}},26751:()=>{}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[8565,4723,1551,5626,8658,1117],()=>t(36741));module.exports=r})();