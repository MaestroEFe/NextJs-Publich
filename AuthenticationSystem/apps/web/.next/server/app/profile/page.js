(()=>{var e={};e.id=4178,e.ids=[4178],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},33053:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(89189),s(48663),s(98355);var a=s(91711),r=s(90149),n=s(82226),i=s.n(n),l=s(75394),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,89189)),"/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,48663)),"/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,98355,23)),"next/dist/client/components/not-found-error"]}],c=["/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/profile/page.tsx"],m="/profile/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},53591:(e,t,s)=>{Promise.resolve().then(s.bind(s,46236))},25383:(e,t,s)=>{Promise.resolve().then(s.bind(s,26484))},65516:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,67545,23)),Promise.resolve().then(s.t.bind(s,73654,23)),Promise.resolve().then(s.t.bind(s,11104,23)),Promise.resolve().then(s.t.bind(s,2614,23)),Promise.resolve().then(s.t.bind(s,17115,23)),Promise.resolve().then(s.t.bind(s,84452,23))},46236:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(60134),r=s(31267),n=s(48141),i=s(7606);let l=()=>{let[e,t]=(0,r.useState)({company:"",jobTitle:"",phone:"",tags:""}),[s,n]=(0,r.useState)(!0),[i,l]=(0,r.useState)(""),[o,d]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/crm/contacts");if(e.ok){let s=await e.json();s&&t({company:s.company||"",jobTitle:s.jobTitle||"",phone:s.phone||"",tags:(s.tags||[]).join(", ")})}}catch(e){d("Failed to load CRM data.")}finally{n(!1)}})()},[]);let c=e=>{let{name:s,value:a}=e.target;t(e=>({...e,[s]:a}))},m=async t=>{t.preventDefault(),d(""),l("");let s={...e,tags:e.tags.split(",").map(e=>e.trim()).filter(Boolean)};try{let e=await fetch("/api/crm/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(e.ok)l("CRM details updated successfully!");else{let t=await e.json();d(t.message||"Failed to update CRM details.")}}catch(e){d("Something went wrong!")}};return s?a.jsx("p",{children:"Loading CRM details..."}):(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mt-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"CRM Details"}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"company",children:"Company"}),a.jsx("input",{type:"text",name:"company",value:e.company,onChange:c,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"jobTitle",children:"Job Title"}),a.jsx("input",{type:"text",name:"jobTitle",value:e.jobTitle,onChange:c,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"phone",children:"Phone"}),a.jsx("input",{type:"text",name:"phone",value:e.phone,onChange:c,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"tags",children:"Tags (comma-separated)"}),a.jsx("input",{type:"text",name:"tags",value:e.tags,onChange:c,className:"w-full p-2 border border-gray-300 rounded"})]}),o&&a.jsx("p",{className:"text-red-500",children:o}),i&&a.jsx("p",{className:"text-green-500",children:i}),a.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"Update CRM Details"})]})]})},o=()=>{let{data:e,update:t}=(0,n.useSession)(),[s,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[m,u]=(0,r.useState)(null),[p,h]=(0,r.useState)(""),[x,g]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(o(e.user?.name||""),c(e.user?.email||""))},[e]);let b=async a=>{a.preventDefault(),g(""),h(""),u(null);let r=i.gV.safeParse({name:s,email:d});if(!r.success){u(r.error);return}try{let s=await fetch("/api/user",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.data)}),a=await s.json();s.ok?(h(a.message),await t({...e,user:{...e?.user,...r.data}})):g(a.message||"Something went wrong!")}catch(e){g("Something went wrong!")}};return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Profile"}),e?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,a.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"name",children:"Name"}),a.jsx("input",{type:"text",id:"name",value:s,onChange:e=>o(e.target.value),className:"w-full p-2 border border-gray-300 rounded"}),m?.flatten().fieldErrors.name&&a.jsx("p",{className:"text-red-500 text-sm",children:m.flatten().fieldErrors.name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:d,onChange:e=>c(e.target.value),className:"w-full p-2 border border-gray-300 rounded"}),m?.flatten().fieldErrors.email&&a.jsx("p",{className:"text-red-500 text-sm",children:m.flatten().fieldErrors.email})]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Role:"})," ",e.user?.group]}),x&&a.jsx("p",{className:"text-red-500",children:x}),p&&a.jsx("p",{className:"text-green-500",children:p}),a.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Update Profile"})]})}),a.jsx(l,{})]}):a.jsx("p",{children:"Loading session..."})]})}},26484:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(60134),r=s(48141);let n=({children:e})=>a.jsx(r.SessionProvider,{children:e})},7606:(e,t,s)=>{"use strict";s.d(t,{dm:()=>n,gY:()=>r,S4:()=>l,gV:()=>i});var a=s(95626);let r=a.z.object({name:a.z.string().min(3,{message:"Name must be at least 3 characters long"}),email:a.z.string().email({message:"Invalid email address"}),password:a.z.string().min(6,{message:"Password must be at least 6 characters long"})}),n=a.z.object({email:a.z.string().email({message:"Invalid email address"}),password:a.z.string().min(1,{message:"Password is required"})}),i=a.z.object({name:a.z.string().min(3).optional(),email:a.z.string().email().optional()}),l=a.z.object({password:a.z.string().min(6,{message:"Password must be at least 6 characters long"})})},48663:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,metadata:()=>d});var a=s(31837),r=s(68819),n=s.n(r),i=s(97113),l=s.n(i);s(26751);let o=(0,s(71694).createProxy)(String.raw`/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/contexts/AuthProvider.tsx#default`),d={title:"OrisGate - Your Gateway to Study Abroad",description:"OrisGate helps students study abroad and provides seamless visa processing services. Your journey to international education starts here.",keywords:"study abroad, visa processing, international education, student travel, OrisGate"};function c({children:e}){return a.jsx("html",{lang:"en",className:`${n().variable} ${l().variable}`,children:a.jsx("body",{className:n().className,children:a.jsx(o,{children:e})})})}},89189:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(71694).createProxy)(String.raw`/home/efe/Documents/NextJs/NextJs-Public/AuthenticationSystem/apps/web/app/profile/page.tsx#default`)},26751:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8565,4723,5626],()=>s(33053));module.exports=a})();