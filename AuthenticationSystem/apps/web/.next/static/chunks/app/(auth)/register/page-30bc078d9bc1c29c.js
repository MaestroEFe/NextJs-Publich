(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{2651:function(e,s,t){Promise.resolve().then(t.bind(t,9532))},9532:function(e,s,t){"use strict";t.r(s);var r=t(5979),a=t(8584),n=t(8104),i=t(1655),l=t(7377),o=t(3578);s.default=()=>{let[e,s]=(0,a.useState)(""),t=(0,n.useRouter)(),d=async e=>{s("");try{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok)t.push("/login");else{let e=await r.json();s(e.message||"Something went wrong!")}}catch(e){s("Something went wrong!")}};return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Register"}),(0,r.jsx)(o.Z,{formType:"register",onSubmit:d,schema:l.gY,apiError:e}),(0,r.jsxs)("p",{className:"mt-4 text-center",children:["Already have an account?"," ",(0,r.jsx)(i.default,{href:"/login",className:"text-blue-500 hover:underline",children:"Login"})]})]})}},3578:function(e,s,t){"use strict";var r=t(5979),a=t(8584);s.Z=e=>{let{formType:s,onSubmit:t,schema:n,apiError:i}=e,[l,o]=(0,a.useState)({}),[d,m]=(0,a.useState)(null),u=e=>{o({...l,[e.target.name]:e.target.value})},c=async e=>{e.preventDefault(),m(null);let s=n.safeParse(l);if(!s.success){m(s.error);return}await t(s.data)};return(0,r.jsxs)("form",{onSubmit:c,className:"space-y-4",children:["register"===s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",children:"Name"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",onChange:u,className:"w-full p-2 border border-gray-300 rounded"}),(null==d?void 0:d.flatten().fieldErrors.name)&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:d.flatten().fieldErrors.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",onChange:u,className:"w-full p-2 border border-gray-300 rounded"}),(null==d?void 0:d.flatten().fieldErrors.email)&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:d.flatten().fieldErrors.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",children:"Password"}),(0,r.jsx)("input",{type:"password",id:"password",name:"password",onChange:u,className:"w-full p-2 border border-gray-300 rounded"}),(null==d?void 0:d.flatten().fieldErrors.password)&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:d.flatten().fieldErrors.password})]}),i&&(0,r.jsx)("p",{className:"text-red-500",children:i}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"login"===s?"Login":"Register"})]})}},7377:function(e,s,t){"use strict";t.d(s,{gY:function(){return u.gY},S4:function(){return u.S4}});var r=t(9399),a=t.n(r);t(9625);var n=t(2228),i=t.n(n);let l=new r.Schema({name:{type:String,required:[!0,"Please provide your name"],trim:!0},email:{type:String,required:[!0,"Please provide your email"],unique:!0,trim:!0,lowercase:!0,match:[/.+@.+\..+/,"Please enter a valid email address"]},password:{type:String,required:[!0,"Please provide a password"],minlength:6,select:!1},group:{type:String,enum:["user","admin"],default:"user"},isVerified:{type:Boolean,default:!1},verificationToken:{type:String,select:!1},verificationTokenExpires:{type:Date,select:!1},passwordResetToken:{type:String,select:!1},passwordResetTokenExpires:{type:Date,select:!1}},{timestamps:!0});l.pre("save",async function(e){if(!this.isModified("password")||!this.password)return e();let s=await i().genSalt(10);this.password=await i().hash(this.password,s),e()}),l.methods.comparePassword=async function(e){return!!this.password&&await i().compare(e,this.password)},a().models.User||a().model("User",l);var o=t(6871),d=t(2221);new o.R(d.env.RESEND_API_KEY),d.env.EMAIL_FROM;let m=new r.Schema({email:{type:String,required:!0},token:{type:String,required:!0,unique:!0},expiresAt:{type:Date,required:!0,expires:"1h"}});a().models.PasswordResetToken||a().model("PasswordResetToken",m);var u=t(917)},917:function(e,s,t){"use strict";t.d(s,{dm:function(){return n},gY:function(){return a},S4:function(){return l},gV:function(){return i}});var r=t(1883);let a=r.z.object({name:r.z.string().min(3,{message:"Name must be at least 3 characters long"}),email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})}),n=r.z.object({email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(1,{message:"Password is required"})}),i=r.z.object({name:r.z.string().min(3).optional(),email:r.z.string().email().optional()}),l=r.z.object({password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})})}},function(e){e.O(0,[937,155,655,883,16,232,922,744],function(){return e(e.s=2651)}),_N_E=e.O()}]);