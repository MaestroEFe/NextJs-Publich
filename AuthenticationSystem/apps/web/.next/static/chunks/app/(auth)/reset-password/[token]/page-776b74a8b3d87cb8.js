(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{4708:function(e,s,t){Promise.resolve().then(t.bind(t,6882))},6882:function(e,s,t){"use strict";t.r(s);var r=t(5979),a=t(8584),n=t(8104),i=t(8733),o=t(183),d=t(7377),l=t(1655);s.default=()=>{let e=(0,n.useRouter)(),s=(0,n.useParams)().token,[t,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),{register:p,handleSubmit:w,formState:{errors:h}}=(0,i.cI)({resolver:(0,o.F)(d.S4)}),g=async t=>{c(""),m("");try{let r=await fetch("/api/auth/reset-password/".concat(s),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t.password})}),a=await r.json();r.ok?(m(a.message),setTimeout(()=>e.push("/login"),3e3)):c(a.message||"Failed to reset password.")}catch(e){c("An unexpected error occurred.")}};return u?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Password Reset Successful"}),(0,r.jsx)("p",{className:"text-green-500",children:u}),(0,r.jsx)("p",{children:"You will be redirected to the login page shortly."}),(0,r.jsx)(l.default,{href:"/login",className:"text-blue-500 hover:underline",children:"Or click here to login now."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Set New Password"}),(0,r.jsxs)("form",{onSubmit:w(g),className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",children:"New Password"}),(0,r.jsx)("input",{type:"password",id:"password",...p("password"),className:"w-full p-2 border border-gray-300 rounded"}),h.password&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:h.password.message})]}),t&&(0,r.jsx)("p",{className:"text-red-500",children:t}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Reset Password"})]})]})}},7377:function(e,s,t){"use strict";t.d(s,{gY:function(){return u.gY},S4:function(){return u.S4}});var r=t(9399),a=t.n(r);t(9625);var n=t(2228),i=t.n(n);let o=new r.Schema({name:{type:String,required:[!0,"Please provide your name"],trim:!0},email:{type:String,required:[!0,"Please provide your email"],unique:!0,trim:!0,lowercase:!0,match:[/.+@.+\..+/,"Please enter a valid email address"]},password:{type:String,required:[!0,"Please provide a password"],minlength:6,select:!1},group:{type:String,enum:["user","admin"],default:"user"},isVerified:{type:Boolean,default:!1},verificationToken:{type:String,select:!1},verificationTokenExpires:{type:Date,select:!1},passwordResetToken:{type:String,select:!1},passwordResetTokenExpires:{type:Date,select:!1}},{timestamps:!0});o.pre("save",async function(e){if(!this.isModified("password")||!this.password)return e();let s=await i().genSalt(10);this.password=await i().hash(this.password,s),e()}),o.methods.comparePassword=async function(e){return!!this.password&&await i().compare(e,this.password)},a().models.User||a().model("User",o);var d=t(6871),l=t(2221);new d.R(l.env.RESEND_API_KEY),l.env.EMAIL_FROM;let c=new r.Schema({email:{type:String,required:!0},token:{type:String,required:!0,unique:!0},expiresAt:{type:Date,required:!0,expires:"1h"}});a().models.PasswordResetToken||a().model("PasswordResetToken",c);var u=t(917)},917:function(e,s,t){"use strict";t.d(s,{dm:function(){return n},gY:function(){return a},S4:function(){return o},gV:function(){return i}});var r=t(1883);let a=r.z.object({name:r.z.string().min(3,{message:"Name must be at least 3 characters long"}),email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})}),n=r.z.object({email:r.z.string().email({message:"Invalid email address"}),password:r.z.string().min(1,{message:"Password is required"})}),i=r.z.object({name:r.z.string().min(3).optional(),email:r.z.string().email().optional()}),o=r.z.object({password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})})}},function(e){e.O(0,[937,155,655,883,183,16,232,922,744],function(){return e(e.s=4708)}),_N_E=e.O()}]);