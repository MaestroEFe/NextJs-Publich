'use client';

import { useState } from 'react';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import Header from '@/components/Header';
import Footer from '@/components/Footer';
import { CheckCircle, DollarSign, Shield, Clock, Plane, Users, ArrowRight } from 'lucide-react';

const buyerSchema = z.object({
  fullName: z.string().min(1, 'Full name is required'),
  companyName: z.string().min(1, 'Company name is required'),
  country: z.string().min(1, 'Country is required'),
  email: z.string().email('Invalid email address'),
  whatsapp: z.string().min(1, 'WhatsApp number is required'),
  commoditiesInterest: z.array(z.string()).min(1, 'Please select at least one commodity'),
  monthlyVolume: z.string().min(1, 'Monthly volume is required'),
  paymentTerms: z.string().optional(),
  deliveryTerms: z.string().optional(),
  additionalRequirements: z.string().optional(),
});

type BuyerFormData = z.infer<typeof buyerSchema>;

const commodities = [
  'Rice', 'Maize', 'Wheat', 'Sorghum', 'Millet',
  'Beans', 'Cowpeas', 'Soybeans', 'Groundnuts',
  'Sesame Seeds', 'Cashew Nuts', 'Cocoa',
  'Ginger', 'Turmeric', 'Chili Pepper'
];

const volumeRanges = [
  '1-10 tons/month',
  '11-50 tons/month',
  '51-100 tons/month',
  '101-500 tons/month',
  '500+ tons/month'
];

export default function BuyerRegistration() {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [submitMessage, setSubmitMessage] = useState('');
  const [selectedCommodities, setSelectedCommodities] = useState<string[]>([]);

  const {
    register,
    handleSubmit,
    formState: { errors },
    reset,
    setValue,
  } = useForm<BuyerFormData>({
    resolver: zodResolver(buyerSchema),
  });

  const handleCommodityChange = (commodity: string) => {
    const updated = selectedCommodities.includes(commodity)
      ? selectedCommodities.filter(c => c !== commodity)
      : [...selectedCommodities, commodity];
    
    setSelectedCommodities(updated);
    setValue('commoditiesInterest', updated);
  };

  const onSubmit = async (data: BuyerFormData) => {
    setIsSubmitting(true);
    setSubmitMessage('');

    try {
      const response = await fetch('/api/buyers', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      });

      if (response.ok) {
        setSubmitMessage('Thank you! Your registration has been submitted successfully. We will contact you within 24 hours.');
        reset();
        setSelectedCommodities([]);
      } else {
        setSubmitMessage('Sorry, there was an error submitting your registration. Please try again.');
      }
    } catch (error) {
      setSubmitMessage('Sorry, there was an error submitting your registration. Please try again.');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <main>
      <Header />
      
      {/* Hero Section */}
      <section className="bg-gradient-to-br from-green-50 to-green-100 py-20">
        <div className="container mx-auto px-4">
          <div className="max-w-4xl mx-auto text-center">
            <h1 className="text-5xl font-bold text-gray-900 mb-6 font-poppins">
              Partner with Nigeria's Most Reliable{' '}
              <span className="text-primary">Agro-Commodity Supplier</span>
            </h1>
            <p className="text-xl text-gray-600 leading-relaxed">
              Join hundreds of satisfied buyers who trust URAT Limited for premium quality 
              commodities, guaranteed payouts, and exceptional service.
            </p>
          </div>
        </div>
      </section>

      {/* Value Propositions */}
      <section className="py-20 bg-white">
        <div className="container mx-auto px-4">
          <div className="text-center mb-16">
            <h2 className="text-4xl font-bold text-gray-900 mb-4 font-poppins">
              Why Choose URAT Limited?
            </h2>
            <p className="text-xl text-gray-600 max-w-2xl mx-auto">
              Six compelling reasons to make us your preferred agro-commodity partner
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {/* Direct Farm Access */}
            <div className="bg-green-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-6">
                <Users className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">Direct Farm Access</h3>
              <p className="text-gray-600 leading-relaxed">
                Source directly from our network of 500+ verified farms across Nigeria, 
                ensuring the best prices and freshest products.
              </p>
            </div>

            {/* Quality Guarantee */}
            <div className="bg-blue-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-6">
                <Shield className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">Quality Guarantee</h3>
              <p className="text-gray-600 leading-relaxed">
                Rigorous testing and quality control processes ensure every shipment 
                meets international standards and your specifications.
              </p>
            </div>

            {/* Fast Payments */}
            <div className="bg-yellow-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-accent rounded-full flex items-center justify-center mx-auto mb-6">
                <Clock className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">24-Hour Payouts</h3>
              <p className="text-gray-600 leading-relaxed">
                Industry-leading payment processing with guaranteed payouts within 
                24 hours of delivery confirmation.
              </p>
            </div>

            {/* Export Support */}
            <div className="bg-purple-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-6">
                <Plane className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">Export Support</h3>
              <p className="text-gray-600 leading-relaxed">
                Complete end-to-end shipping assistance including documentation, 
                customs clearance, and logistics coordination.
              </p>
            </div>

            {/* Flexible Terms */}
            <div className="bg-indigo-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-6">
                <DollarSign className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">Flexible Terms</h3>
              <p className="text-gray-600 leading-relaxed">
                Customizable payment and delivery terms to match your business 
                requirements and cash flow needs.
              </p>
            </div>

            {/* Dedicated Support */}
            <div className="bg-red-50 rounded-xl p-8 text-center">
              <div className="w-16 h-16 bg-accent rounded-full flex items-center justify-center mx-auto mb-6">
                <CheckCircle className="text-white" size={32} />
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-4 font-poppins">Dedicated Support</h3>
              <p className="text-gray-600 leading-relaxed">
                Personal account manager assigned to every buyer for seamless 
                communication and relationship management.
              </p>
            </div>
          </div>
        </div>
      </section>

      {/* Registration Form */}
      <section className="py-20 bg-gray-50">
        <div className="container mx-auto px-4">
          <div className="max-w-3xl mx-auto">
            <div className="text-center mb-12">
              <h2 className="text-4xl font-bold text-gray-900 mb-4 font-poppins">
                Register as a Buyer
              </h2>
              <p className="text-xl text-gray-600">
                Complete the form below to start your partnership with URAT Limited
              </p>
            </div>

            <div className="bg-white rounded-xl shadow-lg p-8">
              <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
                {/* Personal Information */}
                <div>
                  <h3 className="text-lg font-semibold text-gray-900 mb-4 font-poppins">Personal Information</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label htmlFor="fullName" className="block text-sm font-medium text-gray-700 mb-2">
                        Full Name *
                      </label>
                      <input
                        type="text"
                        id="fullName"
                        {...register('fullName')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="Your full name"
                      />
                      {errors.fullName && (
                        <p className="mt-1 text-sm text-red-600">{errors.fullName.message}</p>
                      )}
                    </div>

                    <div>
                      <label htmlFor="companyName" className="block text-sm font-medium text-gray-700 mb-2">
                        Company Name *
                      </label>
                      <input
                        type="text"
                        id="companyName"
                        {...register('companyName')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="Your company name"
                      />
                      {errors.companyName && (
                        <p className="mt-1 text-sm text-red-600">{errors.companyName.message}</p>
                      )}
                    </div>
                  </div>
                </div>

                {/* Contact Information */}
                <div>
                  <h3 className="text-lg font-semibold text-gray-900 mb-4 font-poppins">Contact Information</h3>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                      <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-2">
                        Email Address *
                      </label>
                      <input
                        type="email"
                        id="email"
                        {...register('email')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="your@email.com"
                      />
                      {errors.email && (
                        <p className="mt-1 text-sm text-red-600">{errors.email.message}</p>
                      )}
                    </div>

                    <div>
                      <label htmlFor="whatsapp" className="block text-sm font-medium text-gray-700 mb-2">
                        WhatsApp Number *
                      </label>
                      <input
                        type="tel"
                        id="whatsapp"
                        {...register('whatsapp')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="+234 123 456 7890"
                      />
                      {errors.whatsapp && (
                        <p className="mt-1 text-sm text-red-600">{errors.whatsapp.message}</p>
                      )}
                    </div>

                    <div>
                      <label htmlFor="country" className="block text-sm font-medium text-gray-700 mb-2">
                        Country *
                      </label>
                      <input
                        type="text"
                        id="country"
                        {...register('country')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                        placeholder="Your country"
                      />
                      {errors.country && (
                        <p className="mt-1 text-sm text-red-600">{errors.country.message}</p>
                      )}
                    </div>
                  </div>
                </div>

                {/* Business Requirements */}
                <div>
                  <h3 className="text-lg font-semibold text-gray-900 mb-4 font-poppins">Business Requirements</h3>
                  
                  {/* Commodities Interest */}
                  <div className="mb-6">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Commodities of Interest * (Select all that apply)
                    </label>
                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                      {commodities.map((commodity) => (
                        <label key={commodity} className="flex items-center space-x-2 cursor-pointer">
                          <input
                            type="checkbox"
                            checked={selectedCommodities.includes(commodity)}
                            onChange={() => handleCommodityChange(commodity)}
                            className="rounded border-gray-300 text-primary focus:ring-primary"
                          />
                          <span className="text-sm text-gray-700">{commodity}</span>
                        </label>
                      ))}
                    </div>
                    {errors.commoditiesInterest && (
                      <p className="mt-1 text-sm text-red-600">{errors.commoditiesInterest.message}</p>
                    )}
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                      <label htmlFor="monthlyVolume" className="block text-sm font-medium text-gray-700 mb-2">
                        Monthly Volume *
                      </label>
                      <select
                        id="monthlyVolume"
                        {...register('monthlyVolume')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                      >
                        <option value="">Select volume range</option>
                        {volumeRanges.map((range) => (
                          <option key={range} value={range}>{range}</option>
                        ))}
                      </select>
                      {errors.monthlyVolume && (
                        <p className="mt-1 text-sm text-red-600">{errors.monthlyVolume.message}</p>
                      )}
                    </div>

                    <div>
                      <label htmlFor="paymentTerms" className="block text-sm font-medium text-gray-700 mb-2">
                        Preferred Payment Terms
                      </label>
                      <select
                        id="paymentTerms"
                        {...register('paymentTerms')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                      >
                        <option value="">Select payment terms</option>
                        <option value="advance">100% Advance Payment</option>
                        <option value="delivery">Payment on Delivery</option>
                        <option value="credit-30">30 Days Credit</option>
                        <option value="credit-60">60 Days Credit</option>
                        <option value="lc">Letter of Credit</option>
                      </select>
                    </div>

                    <div>
                      <label htmlFor="deliveryTerms" className="block text-sm font-medium text-gray-700 mb-2">
                        Preferred Delivery Terms
                      </label>
                      <select
                        id="deliveryTerms"
                        {...register('deliveryTerms')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                      >
                        <option value="">Select delivery terms</option>
                        <option value="fob">FOB (Free on Board)</option>
                        <option value="cif">CIF (Cost, Insurance, Freight)</option>
                        <option value="exw">EXW (Ex Works)</option>
                        <option value="dap">DAP (Delivered at Place)</option>
                      </select>
                    </div>
                  </div>
                </div>

                {/* Additional Requirements */}
                <div>
                  <label htmlFor="additionalRequirements" className="block text-sm font-medium text-gray-700 mb-2">
                    Additional Requirements or Comments
                  </label>
                  <textarea
                    id="additionalRequirements"
                    rows={4}
                    {...register('additionalRequirements')}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                    placeholder="Any specific requirements, certifications needed, or additional information..."
                  />
                </div>

                <button
                  type="submit"
                  disabled={isSubmitting}
                  className="w-full btn-primary flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  <span>{isSubmitting ? 'Submitting...' : 'Register as Buyer'}</span>
                  <ArrowRight size={20} />
                </button>

                {submitMessage && (
                  <div className={`text-center p-4 rounded-lg ${
                    submitMessage.includes('Thank you') 
                      ? 'bg-green-100 text-green-700' 
                      : 'bg-red-100 text-red-700'
                  }`}>
                    {submitMessage}
                  </div>
                )}
              </form>
            </div>
          </div>
        </div>
      </section>

      {/* Process Steps */}
      <section className="py-20 bg-white">
        <div className="container mx-auto px-4">
          <div className="text-center mb-16">
            <h2 className="text-4xl font-bold text-gray-900 mb-4 font-poppins">
              How It Works
            </h2>
            <p className="text-xl text-gray-600 max-w-2xl mx-auto">
              Simple 4-step process to start trading with URAT Limited
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div className="text-center">
              <div className="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-white font-bold text-xl">1</span>
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-2 font-poppins">Register Interest</h3>
              <p className="text-gray-600">Complete the registration form with your requirements</p>
            </div>

            <div className="text-center">
              <div className="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-white font-bold text-xl">2</span>
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-2 font-poppins">Verification</h3>
              <p className="text-gray-600">Our team verifies your information and business credentials</p>
            </div>

            <div className="text-center">
              <div className="w-16 h-16 bg-accent rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-white font-bold text-xl">3</span>
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-2 font-poppins">Product Selection</h3>
              <p className="text-gray-600">Browse available products and place your first order</p>
            </div>

            <div className="text-center">
              <div className="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                <span className="text-white font-bold text-xl">4</span>
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-2 font-poppins">Delivery</h3>
              <p className="text-gray-600">Receive your quality commodities with full documentation</p>
            </div>
          </div>
        </div>
      </section>

      {/* Testimonials */}
      <section className="py-20 bg-gray-50">
        <div className="container mx-auto px-4">
          <div className="text-center mb-16">
            <h2 className="text-4xl font-bold text-gray-900 mb-4 font-poppins">
              What Our Buyers Say
            </h2>
            <p className="text-xl text-gray-600">
              Success stories from satisfied partners around the world
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div className="bg-white rounded-xl p-8 shadow-lg">
              <div className="mb-6">
                <div className="flex text-yellow-400 mb-4">
                  {[...Array(5)].map((_, i) => (
                    <span key={i}>★</span>
                  ))}
                </div>
                <p className="text-gray-600 italic">
                  "URAT Limited has been our most reliable supplier for over 2 years. 
                  Their quality consistency and timely deliveries have helped us grow our business significantly."
                </p>
              </div>
              <div>
                <p className="font-semibold text-gray-900">Ahmed Hassan</p>
                <p className="text-gray-600">CEO, Middle East Trading Co.</p>
              </div>
            </div>

            <div className="bg-white rounded-xl p-8 shadow-lg">
              <div className="mb-6">
                <div className="flex text-yellow-400 mb-4">
                  {[...Array(5)].map((_, i) => (
                    <span key={i}>★</span>
                  ))}
                </div>
                <p className="text-gray-600 italic">
                  "The 24-hour payout guarantee is not just a promise - they actually deliver on it. 
                  This has greatly improved our cash flow management."
                </p>
              </div>
              <div>
                <p className="font-semibold text-gray-900">Sarah Johnson</p>
                <p className="text-gray-600">Procurement Manager, Global Foods Ltd.</p>
              </div>
            </div>

            <div className="bg-white rounded-xl p-8 shadow-lg">
              <div className="mb-6">
                <div className="flex text-yellow-400 mb-4">
                  {[...Array(5)].map((_, i) => (
                    <span key={i}>★</span>
                  ))}
                </div>
                <p className="text-gray-600 italic">
                  "Exceptional quality control and transparent communication. 
                  URAT Limited has become our preferred partner for Nigerian commodities."
                </p>
              </div>
              <div>
                <p className="font-semibold text-gray-900">Chen Wei</p>
                <p className="text-gray-600">Director, Asian Import Solutions</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <Footer />
    </main>
  );
}

